<!DOCTYPE html><html lang="en"><head><title>CK - Creating a Simple Yet Complicated Dark Mode Animation</title><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="index, follow" name="robots"><meta content="Çelik Köseoğlu" name="author"><link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"><link href="/favicon-32x32.png" rel="alternate icon" sizes="32x32" type="image/png"><link href="/favicon-16x16.png" rel="alternate icon" sizes="16x16" type="image/png"><link href="/favicon.svg" rel="icon"><link href="/site.webmanifest" rel="manifest"><link href="/safari-pinned-tab.svg" rel="mask-icon" color="#111111"><meta content="#2b5797" name="msapplication-TileColor"><meta content="#111111" name="theme-color"><link href="/static/css/main.1643f0fc.chunk.css" rel="stylesheet"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><meta content="CK - Creating a Simple Yet Complicated Dark Mode Animation" data-react-helmet="true" property="og:title"><meta content="A dark mode toggle animation should have some personality. Here's my take on a unique dark mode transition animation." name="description" data-react-helmet="true"><meta content="A dark mode toggle animation should have some personality. Here's my take on a unique dark mode transition animation." data-react-helmet="true" property="og:description"><meta content="https://celikk.me/static/media/circleAnimationIllustration.9ac9182c.jpg" data-react-helmet="true" property="og:image"><meta content="https://celikk.me/blog/darkModeAnimation" data-react-helmet="true" property="og:url"><meta content="summary_large_image" name="twitter:card" data-react-helmet="true"><meta content="A circle growing outward from the center of the moon icon" name="twitter:image:alt" data-react-helmet="true"><meta content="@celikkoseoglu" name="twitter:site" data-react-helmet="true"></head><body style="background-color:#fff"><div id="root"><div class="false BlogPost_blogPostBody__3Xs1p"><canvas class="GrowingCircleAnimation_size__2-IIk" height="425" width="240"></canvas><div class="BlogPost_width__1ErQ0"><div class="BlogPost_blogContainer__q6UOx"><div class="BlogNavbar_navbarFlex__3E3tf BlogPost_blogPostNavbarMargin__1GGI9"><div class="BlogNavbar_brandingContainer__Z9V-I"><a href="/" class="null UnstyledLink_noDecoration__BUHZv"><svg viewBox="0 0 504 715" class="BlogNavbar_branding__YaKdk false" id="branding" version="1.1" visibility="hidden"><path d="M446.7,696.8c-86,24-172.1,24-258.5,0.7c23.9-11.2,63.2-25.8, 113.5-28.5C368.7,665.4,420.5,684.8,446.7,696.8z" class="BlogBrandingLogo_lightFill__152qR BlogBrandingLogo_colorTransition__1B_hI" opacity="0"><animate attributeName="opacity" dur="0.06" fill="freeze" from="0" to="1" begin="enter.end"></animate></path><path d="M472.8,104.3c-21.6-16.1-79.8-51.9-157-51.9c-145.3,0-263.2,117.8-263.2, 263.2c0,159.2,144.4,259.3,263.2,263.2c74.8,2.5,132.1-33.5,156-51.2" class="BlogBrandingLogo_lightStroke__1Ar3e BlogBrandingLogo_colorTransition__1B_hI" fill="transparent" id="linePath" stroke-dasharray="1170" stroke-width="103"><animate attributeName="stroke-dashoffset" dur="0.5" fill="freeze" from="1170" to="0" id="enter" calcMode="spline" keySplines="0.42 0 0.58 1" keyTimes="0;1"></animate><animate attributeName="stroke-dashoffset" dur="0.4" fill="freeze" from="540" to="980" begin="branding.click" id="exit"></animate></path><set attributeName="visibility" from="hidden" to="visible"></set></svg></a><a href="/blog" class="BlogNavbar_blogLinkBranding__1vYJb BlogNavbar_pointerCursor__Umcvr UnstyledLink_noDecoration__BUHZv"><h1 class="BlogNavbar_noMargin__2Qg3V BlogNavbar_titleFont__36HET">BLOG</h1></a></div><div class="BlogNavbar_darkModeToggle__2ZstR"><button aria-label="Dark Mode Toggle" class="DarkModeToggle_sun__KtjuS DarkModeToggle_darkModeToggle__3wAbI" type="button"><div class="DarkModeToggle_crescent__3o8z9"></div></button></div></div><div class="BlogPostMarkdown_blogPostStyle__3faQv false"><div><h1 id="creating-a-simple-yet-complicated-dark-mode-animation">Creating a Simple Yet Complicated Dark Mode Animation</h1><h3 id="a-dark-mode-toggle-animation-should-have-some-personality-heres-my-take-on-a-unique-dark-mode-transition-animation">A dark mode toggle animation should have some personality. Here's my take on a unique dark mode transition animation.</h3><h6 id="dec-20-2020---30-min-read">Dec 20, 2020 - 30 min read</h6><p>Most dark mode animations on the web look the same. This is why I wanted to create my own. Don't get me wrong, there is nothing wrong with a simple color transition. It just doesn't feel unique when almost everyone on the web use the same thing. So, here is my take on it. I'll first explain everything in a YouTube video, and then try to provide more details in text.</p><ul><li><a href="https://www.youtube.com/watch?v=oIHuvg38qLE">Part 1 - Introduction and Basic Concepts</a></li><li><a href="https://www.youtube.com/watch?v=dgXbpUxdv8I">Part 2 - Implementation</a></li></ul><p>In very basic terms, this animation is just a HTML canvas that draws a shrinking circle. The circle shrinks or grows in size depending on if we want dark mode enabled or not. Plus, it integrates nicely with React's component states.</p><h4 id="1-what-kind-of-animation-do-i-want">1) What kind of animation do I want?</h4><div class="MediaCarousel_horizontalOverflow__2dCuM null MediaCarousel_mediaCarousel__3h4MF false" align="center"><img alt="/static/media/circleAnimationIllustration.9ac9182c.jpg" class="MediaCarousel_autoSizeImage__3N7yZ false false" src="/static/media/circleAnimationIllustration.9ac9182c.jpg"></div><p><strong>a.</strong> When I click on the moon icon, the website should start drawing a circle that continuously shrinks until radius is zero. The center of the circle should be the moon icon.</p><p><strong>b.</strong> When I click on the sun icon, the website should start drawing a circle that continuously grows until the circle covers the entire background of the page. The center of the circle should be the sun icon.</p><p><strong>c.</strong> If the animation is still playing when I click the icon, the animation should continue playing in reverse.</p><p><strong>d.</strong> The animation should stop when radius reaches zero, or when radius is bigger than the page width (animation is not visible anymore).</p><h4 id="2-what-are-my-options">2) What are my options?</h4><p>First option that comes to mind is to use a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API">HTML canvas</a>. Canvas allows drawing an arbitrary shape on a webpage at any given time. I need to integrate this with React and the dark mode state on my blog. The performance needs to be good enough to create the illusion of a circle growing. I do not want skipped frames.</p><p>Second option could be to use a div with 100% corner radius and resize it using javascript. However, this might be quite hacky and might introduce compatibility problems on older browsers, or maybe some newer browsers. Safari updates have caused several CSS bugs on my website before.</p><p>My recommendation is to go with a canvas.</p><h4 id="3-how-do-i-work-with-a-canvas-in-react">3) How do I work with a canvas in React?</h4><p>The <a href="https://reactjs.org/docs/hooks-reference.html#useref">useRef()</a> hook can be used to get the reference for the element you're working with on the DOM. This way, we can refer back to our canvas and start drawing on it.</p><p>Here is a sample Canvas component that you can plug in and try now. It just draws a circle when mounted.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#07a">import</span><span> React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span> useEffect</span><span class="token" style="color:#999">,</span><span> useRef </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">"react"</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">CircleCanvas</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> canvasRef </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#dd4a68">useRef</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#dd4a68">useEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> context </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> canvasRef</span><span class="token" style="color:#999">.</span><span>current</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">getContext</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">"2d"</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>    context</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">clearRect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> context</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>width</span><span class="token" style="color:#999">,</span><span> context</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>height</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    context</span><span class="token" style="color:#999">.</span><span>fillStyle </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#690">"#00F"</span><span class="token" style="color:#999">;</span><span>
</span><span>    context</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">beginPath</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    context</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">arc</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">75</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">75</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">60</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">2</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">*</span><span> Math</span><span class="token" style="color:#999">.</span><span class="token" style="color:#905">PI</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    context</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">fill</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>    window</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">requestAnimationFrame</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">&lt;</span><span>canvas ref</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span class="token" style="color:#999">{</span><span>canvasRef</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">></span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">default</span><span> CircleCanvas</span><span class="token" style="color:#999">;</span></code></pre></div><h4 id="4-drawing-a-circle-that-continuously-grows">4) Drawing a circle that continuously grows</h4><p>Up next is animating a circle that continuously grows. The canvas provides us with a function called requestAnimationFrame(callback). This function draws whatever you have in the context, and then calls the callback function when the drawing is done.</p><p>So the logic we're going to follow here is pretty simple. We're going to increase the circle radius by 0.05 each time render() is called by the requestAnimationFrame callback.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#07a">import</span><span> React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>useEffect</span><span class="token" style="color:#999">,</span><span> useRef</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">"react"</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">GrowingCircleCanvas</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> canvasRef </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#dd4a68">useRef</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">draw</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token parameter">ctx</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> radius</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">clearRect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> ctx</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>width</span><span class="token" style="color:#999">,</span><span> ctx</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>height</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span>fillStyle </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#690">"#00F"</span><span class="token" style="color:#999">;</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">beginPath</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">arc</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">50</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">100</span><span class="token" style="color:#999">,</span><span> radius</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">2</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">*</span><span> Math</span><span class="token" style="color:#999">.</span><span class="token" style="color:#905">PI</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">fill</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#dd4a68">useEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> context </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> canvasRef</span><span class="token" style="color:#999">.</span><span>current</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">getContext</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">"2d"</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> radius </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> animationFrameId</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">render</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      radius </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">+=</span><span> </span><span class="token" style="color:#905">0.05</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#dd4a68">draw</span><span class="token" style="color:#999">(</span><span>context</span><span class="token" style="color:#999">,</span><span> radius</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>      animationFrameId </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> window</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">requestAnimationFrame</span><span class="token" style="color:#999">(</span><span>render</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#dd4a68">render</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>    </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      window</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">cancelAnimationFrame</span><span class="token" style="color:#999">(</span><span>animationFrameId</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span>draw</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">&lt;</span><span>canvas ref</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span class="token" style="color:#999">{</span><span>canvasRef</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">></span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">default</span><span> GrowingCircleCanvas</span><span class="token" style="color:#999">;</span></code></pre></div><p>This allows us to get a circle growing at a constant speed. There is no way to make the circle smaller yet, but that's ok. We're going to address that issue at a later stage.</p><h4 id="5-adjusting-the-scaling-and-resolution-for-the-canvas">5) Adjusting the scaling and resolution for the canvas</h4><p>Depending on how you placed your canvas in your page, you might have noticed that the canvas looks pixelated. This happens because we manually need to adjust the scaling factor of the canvas. All devices come with different screen pixel ratios. Here is the code that adjusts canvas draw resolution. Place it in your useEffect() function.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#999">{</span><span> width</span><span class="token" style="color:#999">,</span><span> height </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> context</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">getBoundingClientRect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span>context</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>width </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">!==</span><span> width </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">||</span><span> context</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>height </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">!==</span><span> height</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#999">{</span><span> devicePixelRatio</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> originalRatio </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#905">1</span><span> </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> window</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#708090">// we don't need such a high resolution for this type of animation. Plus it makes the edges</span><span>
</span><span>  </span><span class="token" style="color:#708090">// of the circle look blurred, which looks nicer. Also improves performance a lot on slow GPUs</span><span>
</span><span>  </span><span class="token" style="color:#708090">// change from 0.5 to 1 if you want to use display's native resolution.</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> lowerResolutionRatio </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> originalRatio </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">*</span><span> </span><span class="token" style="color:#905">0.5</span><span class="token" style="color:#999">;</span><span>
</span><span>  context</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>width </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> width </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">*</span><span> lowerResolutionRatio</span><span class="token" style="color:#999">;</span><span>
</span><span>  context</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>height </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> height </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">*</span><span> lowerResolutionRatio</span><span class="token" style="color:#999">;</span><span>
</span><span>  context</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">scale</span><span class="token" style="color:#999">(</span><span>lowerResolutionRatio</span><span class="token" style="color:#999">,</span><span> lowerResolutionRatio</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre></div><h4 id="6-time-based-rendering-for-consistency">6) Time-based rendering for consistency</h4><p>When you're programming animations, it's a good practise for your animation speed to be based off of real time. Let me explain by a simple example:</p><div class="MediaCarousel_horizontalOverflow__2dCuM null MediaCarousel_mediaCarousel__3h4MF MediaCarousel_multipleImage__2TpDP" align="center"><video autoplay class="MediaCarousel_autoSizeImage__3N7yZ MediaCarousel_autoSizeMultipleImage__6Bidj false" loop playsinline=""><source src="/static/media/cpu_limited_rendering.eee49532.mp4" type="video/mp4">Your browser does not support the video tag.</video><video autoplay class="MediaCarousel_autoSizeImage__3N7yZ MediaCarousel_autoSizeMultipleImage__6Bidj MediaCarousel_imageMargin__1MMor" loop playsinline=""><source src="/static/media/normal_rendering.f4032c9d.mp4" type="video/mp4">Your browser does not support the video tag.</video></div><p>On the left, there is a laptop from 2006 with a highly underclocked CPU. On the right, I have my 2019 laptop. If it takes more time to draw a frame on a slow CPU, the animation should not slow down right? We want the animation to take the same amount of time on the same screen size. If the CPU is too slow, then we should let the animation skip a few frames. This is what games do as well. If your computer is slow, frames per second will be lower but physics and animations will be playing out exactly the same as a super fast computer.</p><div class="MediaCarousel_horizontalOverflow__2dCuM null MediaCarousel_mediaCarousel__3h4MF MediaCarousel_multipleImage__2TpDP" align="center"><video autoplay class="MediaCarousel_autoSizeImage__3N7yZ MediaCarousel_autoSizeMultipleImage__6Bidj false" loop playsinline=""><source src="/static/media/slow_cpu_time_based_rendering.645a2261.mp4" type="video/mp4">Your browser does not support the video tag.</video><video autoplay class="MediaCarousel_autoSizeImage__3N7yZ MediaCarousel_autoSizeMultipleImage__6Bidj MediaCarousel_imageMargin__1MMor" loop playsinline=""><source src="/static/media/normal_rendering.f4032c9d.mp4" type="video/mp4">Your browser does not support the video tag.</video></div><p>Time delta between current and previous frames can be used to calculate what the radius should be. If there is a 10 ms difference between frames, the radius should be growing at a rate of 10 pixels per draw. If there is a 100ms difference between frames, the radius should be growing at a rate of 100 pixels per draw and so on.</p><p>This logic can be implemented with the code fragment below. When we're calculating the radius for the next frame, we're going to subtract the time at previous completion from now. This value is going to be multiplied with RADIUS_INCREASE_PER_MS to get the actual radius.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#07a">import</span><span> React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>useEffect</span><span class="token" style="color:#999">,</span><span> useRef</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">"react"</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">GrowingCircleCanvasTime</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> canvasRef </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#dd4a68">useRef</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">RADIUS_INCREASE_PER_MS</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#905">0.05</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">let</span><span> timeAtPreviousDraw </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> Date</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">now</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">draw</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token parameter">ctx</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> radius</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">clearRect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> ctx</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>width</span><span class="token" style="color:#999">,</span><span> ctx</span><span class="token" style="color:#999">.</span><span>canvas</span><span class="token" style="color:#999">.</span><span>height</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span>fillStyle </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#690">"#FFF"</span><span class="token" style="color:#999">;</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">beginPath</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">arc</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">50</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">100</span><span class="token" style="color:#999">,</span><span> radius</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">2</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">*</span><span> Math</span><span class="token" style="color:#999">.</span><span class="token" style="color:#905">PI</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    ctx</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">fill</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#dd4a68">useEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> context </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> canvasRef</span><span class="token" style="color:#999">.</span><span>current</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">getContext</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">"2d"</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> radius </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> animationFrameId</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">render</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token" style="color:#07a">const</span><span> timeAtRenderStart </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> Date</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">now</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#07a">const</span><span> timePastSincePreviousDraw </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> timeAtRenderStart </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">-</span><span> timeAtPreviousDraw</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#708090">// In the future, we will get computers so fast that the difference between</span><span>
</span><span>      </span><span class="token" style="color:#708090">// previous and current frame is less than 1ms. Math.max() ensures that we</span><span>
</span><span>      </span><span class="token" style="color:#708090">// still grow the circle even if the computer is super fast.</span><span>
</span><span>      </span><span class="token" style="color:#07a">const</span><span> timePastSinceLastDraw </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> Math</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">max</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> timePastSincePreviousDraw</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>      radius </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">+=</span><span> </span><span class="token" style="color:#905">RADIUS_INCREASE_PER_MS</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">*</span><span> timePastSinceLastDraw</span><span class="token" style="color:#999">;</span><span>
</span><span>      timeAtPreviousDraw </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> timeAtRenderStart</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#dd4a68">draw</span><span class="token" style="color:#999">(</span><span>context</span><span class="token" style="color:#999">,</span><span> radius</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>      animationFrameId </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> window</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">requestAnimationFrame</span><span class="token" style="color:#999">(</span><span>render</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#dd4a68">render</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>    </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      window</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">cancelAnimationFrame</span><span class="token" style="color:#999">(</span><span>animationFrameId</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span>draw</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">&lt;</span><span>canvas ref</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span class="token" style="color:#999">{</span><span>canvasRef</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">></span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">default</span><span> GrowingCircleCanvasTime</span><span class="token" style="color:#999">;</span></code></pre></div><h4 id="7-making-the-animation-look-nicer">7) Making the animation look nicer</h4><p>Animations don't look as nice when they play at a constant speed. Imagine you're scrolling on your smartphone. The animation starts fast as you flick your finger and then slows down gradually right? Or when you quit an app, there is always some sort of speed-up or slow-down as the animation plays. This behaviour creates the illusion that the animation is more fluid and responsive. Those animations rely on exponential mathematical functions to achieve the aforementioned behaviour. For the growing circle animation, I've tried several different functions and liked this one the best:</p><div class="MediaCarousel_horizontalOverflow__2dCuM null MediaCarousel_mediaCarousel__3h4MF false" align="center"><img alt="/static/media/exponential_function.4607f60c.webp" class="MediaCarousel_autoSizeImage__3N7yZ false false" src="/static/media/exponential_function.4607f60c.webp"></div><p>This will ensure that the circle starts growing slowly at first and then exponentially gets faster. This behaviour makes the whole animation feel more alive. See comparisons below (exponential on the left, linear on the right):</p><div class="MediaCarousel_horizontalOverflow__2dCuM null MediaCarousel_mediaCarousel__3h4MF MediaCarousel_multipleImage__2TpDP" align="center"><video autoplay class="MediaCarousel_autoSizeImage__3N7yZ MediaCarousel_autoSizeMultipleImage__6Bidj false" loop playsinline=""><source src="/static/media/exponential_growth.856d5dcc.mp4" type="video/mp4">Your browser does not support the video tag.</video><video autoplay class="MediaCarousel_autoSizeImage__3N7yZ MediaCarousel_autoSizeMultipleImage__6Bidj MediaCarousel_imageMargin__1MMor" loop playsinline=""><source src="/static/media/linear_growth.eca43cf6.mp4" type="video/mp4">Your browser does not support the video tag.</video></div><h4 id="8-when-to-stop-the-animation">8) When to stop the animation</h4><p>So knowing when to stop when shrinking the circle is simple. When the radius reaches zero, we can stop drawing the circle and stop animating. What if the circle is growing though? The radius is going to be different for all screen sizes. The radius of the circle on a smartphone vs a 27" monitor will be very different. Plus, we are working backwards from an exponentially increasing radius. Here is what we need to figure out when to stop:</p><p><strong>1.</strong> Browser window width and height - We don't need to keep drawing circles if the radius is way past the screen size. There is no point in animating if the user can't see the animation.</p><p><strong>2.</strong> Maximum radius for given window width and height - We're going to use this to figure out the maximum value that the exponential growth function can take.</p><p>For the first item, <code>window.innerHeight</code> and <code>window.innerWidth</code> can be used. For the second item, we can reverse the exponential function and get the maximum value our actual radius can take before the exponential operation.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#07a">const</span><span> screenHeight </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> window</span><span class="token" style="color:#999">.</span><span>screen</span><span class="token" style="color:#999">.</span><span>height</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> screenWidth </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> window</span><span class="token" style="color:#999">.</span><span>screen</span><span class="token" style="color:#999">.</span><span>height</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> maxRadiusMultiplier </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> Math</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">pow</span><span class="token" style="color:#999">(</span><span>Math</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">max</span><span class="token" style="color:#999">(</span><span>screenWidth</span><span class="token" style="color:#999">,</span><span> screenHeight</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">1.0</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span> </span><span class="token" style="color:#905">GROWTH_FUNCTION_EXPONENTIAL</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre></div><p>When animating, the current radiusMultiplier can be compared with the maxRadiusMultiplier. If we're past maxRadiusMultiplier, then it's time to stop animating.</p><h4 id="9-using-canvas-as-page-background">9) Using canvas as page background</h4><p>This canvas is going to cover the whole background of the page. This means the width and height must be set accordingly for this canvas. CSS properties can be used to adjust this. Apart from that, canvas needs to stay at the back of all other items on the page. CSS z-index property will be useful. Finally, when there is nothing on the canvas, it behaves as a transparent layer. The background property should be the colour that you want to display in your <code>dark mode</code>.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-sass" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#690">.size</span><span>
</span><span></span><span class="token property-line">  </span><span class="token property-line" style="color:#905">width</span><span class="token property-line" style="color:#999">:</span><span class="token property-line"> 100vw</span><span>
</span><span></span><span class="token property-line">  </span><span class="token property-line" style="color:#905">height</span><span class="token property-line" style="color:#999">:</span><span class="token property-line"> 100vh</span><span>
</span><span></span><span class="token property-line">  </span><span class="token property-line" style="color:#905">position</span><span class="token property-line" style="color:#999">:</span><span class="token property-line"> fixed</span><span>
</span><span></span><span class="token property-line">  </span><span class="token property-line" style="color:#905">z-index</span><span class="token property-line" style="color:#999">:</span><span class="token property-line"> -1</span><span>
</span><span></span><span class="token property-line">  </span><span class="token property-line" style="color:#905">background</span><span class="token property-line" style="color:#999">:</span><span class="token property-line"> #111</span></code></pre></div><h4 id="10-start-drawing-on-dark-mode-toggle-click">10) Start Drawing On Dark Mode Toggle Click</h4><p>The canvas we have currently draws growing circle on render but how do we start drawing on a mouse click event?</p><p>This is where I'm going to define my CustomEvent. A custom event is very similar to a MouseEvent or ResizeEvent or any other event you've probably come across when working with browser event listeners in JavaScript. A CustomEvent allows you to fire events at any given point in your code. This event can be caught by an event listener attached to another component in your codebase. For my use-case, I'm going to create a custom event in DarkModeToggle component. This component houses the button that the user clicks to toggle dark mode. When the button is clicked, DarkModeToggle component is going to fire an event. This event will be caught by my canvas component.</p><p>Additionally, CustomEvents can take parameters and pass them together in the event object. When a user clicks the dark mode toggle, the button's coordinates will be sent together with the event. Canvas component will use these coordinates as the center of the circle.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#07a">const</span><span> circleCenterCoordinates </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  x</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">,</span><span>
</span><span>  y</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">GrowingCircleAnimation</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token parameter" style="color:#999">{</span><span class="token parameter"> isDark </span><span class="token parameter" style="color:#999">}</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#dd4a68">useEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span> 
<span>    </span><span class="token" style="color:#999">.</span><span>
</span><span>    </span><span class="token" style="color:#999">.</span><span>
</span> 
<span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">handleClick</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token parameter">event</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token" style="color:#708090">// fill in the mouse coordinates when we receive a click so we know the center of the circle</span><span>
</span><span>      circleCenterCoordinates</span><span class="token" style="color:#999">.</span><span>x </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> event</span><span class="token" style="color:#999">.</span><span>detail</span><span class="token" style="color:#999">.</span><span>x</span><span class="token" style="color:#999">;</span><span>
</span><span>      circleCenterCoordinates</span><span class="token" style="color:#999">.</span><span>y </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> event</span><span class="token" style="color:#999">.</span><span>detail</span><span class="token" style="color:#999">.</span><span>y</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>    window</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">addEventListener</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">"darkModeToggle"</span><span class="token" style="color:#999">,</span><span> handleClick</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      isStateMachinePowered </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#905">false</span><span class="token" style="color:#999">;</span><span>
</span><span>      window</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">removeEventListener</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">"darkModeToggle"</span><span class="token" style="color:#999">,</span><span> handleClick</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">&lt;</span><span>canvas ref</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span class="token" style="color:#999">{</span><span>canvasRef</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">></span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span></code></pre></div><p>This is only the listener part of the code. Up next, DarkModeToggle needs an update.</p><h4 id="11-get-mouse-coordinates-of-the-dark-mode-toggle">11) Get Mouse Coordinates of the Dark Mode Toggle</h4><p>The CustomEvent created in the previous step can be used to pass some data. In this case, the mouse coordinates of the dark mode toggle button are passed in the event. This event then gets picked up by the canvas component. Canvas component extracts the coordinates and sets them as the center coordinates of the circle.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">onClickWrapper</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token parameter">onClickMethod</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> isDark</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> event</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> bodyRect </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> document</span><span class="token" style="color:#999">.</span><span>body</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">getBoundingClientRect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> elemRect </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> event</span><span class="token" style="color:#999">.</span><span>target</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">getBoundingClientRect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> offsetLeft </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> elemRect</span><span class="token" style="color:#999">.</span><span>left </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">-</span><span> bodyRect</span><span class="token" style="color:#999">.</span><span>left</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#07a">const</span><span> customEventState </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#708090">// custom object to wrap event data</span><span>
</span><span>    x</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> offsetLeft </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">+</span><span> elemRect</span><span class="token" style="color:#999">.</span><span>width </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span> </span><span class="token" style="color:#905">2</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#708090">// center coordinates of the dark mode toggle on the x-axis</span><span>
</span><span>    y</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> elemRect</span><span class="token" style="color:#999">.</span><span>top </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">+</span><span> elemRect</span><span class="token" style="color:#999">.</span><span>height </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span> </span><span class="token" style="color:#905">2</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#708090">// center coordinates of the dark mode toggle on the y-axis</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span> 
<span>  </span><span class="token" style="color:#07a">const</span><span> darkModeToggleEvent </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#07a">new</span><span> </span><span class="token" style="color:#dd4a68">CustomEvent</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">"darkModeToggle"</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span> detail</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> customEventState </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#dd4a68">onClickMethod</span><span class="token" style="color:#999">(</span><span>isDark</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  storage</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">setItem</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">"theme"</span><span class="token" style="color:#999">,</span><span> isDark</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">toString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#dd4a68">dispatchEvent</span><span class="token" style="color:#999">(</span><span>darkModeToggleEvent</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">DarkModeToggle</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token parameter" style="color:#999">{</span><span class="token parameter"> isDark</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> onClickMethod </span><span class="token parameter" style="color:#999">}</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span>
</span><span>    </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">&lt;</span><span>button
</span><span>      type</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span class="token" style="color:#690">"button"</span><span>
</span><span>      aria</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">-</span><span>label</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span class="token" style="color:#690">"Dark Mode Toggle"</span><span>
</span><span>      onClick</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">(</span><span class="token parameter">event</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#dd4a68">onClickWrapper</span><span class="token" style="color:#999">(</span><span>onClickMethod</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">!</span><span>isDark</span><span class="token" style="color:#999">,</span><span> event</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">}</span><span>
</span><span>      className</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span class="token" style="color:#999">{</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation">isDark </span><span class="token template-string interpolation" style="color:#9a6e3a;background:rgba(255,255,255,.5)">?</span><span class="token template-string interpolation"> moon </span><span class="token template-string interpolation" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span class="token template-string interpolation"> sun</span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string" style="color:#690"> </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation">darkModeToggle</span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">></span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">&lt;</span><span>div className</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span class="token" style="color:#999">{</span><span>crescent</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">></span><span>
</span><span>    </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">&lt;</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span>button</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">></span><span>
</span><span>  </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span></code></pre></div><h4 id="12-designing-a-state-machine">12) Designing a state machine</h4><p>Animation code requires <strong>consistent</strong> structure. I can use what we have at hand so far. Yes, it just draws a growing circle, but that's ok. I can reverse the animation by subtracting the radius instead of adding it on each render. In fact, I've done that. I've quickly realised it was turning into this mess that I would never be able to explain on a YouTube video, nor a blog post. I had to come up with a good solution.</p><p>A finite state machine can be used to drive this animation. If you think about it, we have two main states. <code>IsDark</code>, or <code>!IsDark</code>. Following that, we always have a shrinking or a growing circle. This is the machine diagram I managed to come up with:</p><div class="MediaCarousel_horizontalOverflow__2dCuM null MediaCarousel_mediaCarousel__3h4MF false" align="center"><img alt="/static/media/state_machine_diagram.a4b3a443.webp" class="MediaCarousel_autoSizeImage__3N7yZ false false" src="/static/media/state_machine_diagram.a4b3a443.webp"></div><p>When we land on the page with the canvas, we need to initialise the canvas driver state machine. Right after the initialisation, we kick off the machine. The state machine either keep shrinking or growing the circle depending on if the state is <code>IsDark</code> or <code>!IsDark</code>. When the circle radius reaches zero or maximum, state machine ends operation. This approach was way cleaner compared to what I had before.</p><h4 id="13-implementing-the-state-machine">13) Implementing the state machine</h4><p>At the top, I have a list of global state variables. These variables are accessible from every state of my machine. Then, I have a list of states. Each state evaluates some variables, manipulates the canvas if necessary and then returns the next state. If there is no next state, it returns null. Here is a very pseudo-code version.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#708090">// circle animation state machine</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> m </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  ctx</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#708090">// canvas context</span><span>
</span><span>  isDark</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">,</span><span>
</span><span>  radiusMultiplier</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#708090">// current radius</span><span>
</span><span>  maxRadiusMultiplier</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#708090">// maximum possible radius for the given screen size</span><span>
</span><span>  timeAtPreviousDraw</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">,</span><span>
</span> 
<span>  </span><span class="token function-variable" style="color:#dd4a68">createMachine</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token parameter">ctx</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> isDark</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#708090">// do some setup</span><span>
</span><span>    </span><span class="token" style="color:#07a">return</span><span> m</span><span class="token" style="color:#999">.</span><span>start</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token function-variable" style="color:#dd4a68">start</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">return</span><span> m</span><span class="token" style="color:#999">.</span><span>isDark </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">?</span><span> m</span><span class="token" style="color:#999">.</span><span>shrinkCircle </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> m</span><span class="token" style="color:#999">.</span><span>growCircle</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token function-variable" style="color:#dd4a68">growCircle</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#708090">// make radius bigger</span><span>
</span><span>    </span><span class="token" style="color:#07a">return</span><span> m</span><span class="token" style="color:#999">.</span><span>verifyCircleBounds</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token function-variable" style="color:#dd4a68">shrinkCircle</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#708090">// make radius smaller</span><span>
</span><span>    </span><span class="token" style="color:#07a">return</span><span> m</span><span class="token" style="color:#999">.</span><span>verifyCircleBounds</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token function-variable" style="color:#dd4a68">verifyCircleBounds</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#708090">// if circle is outside of the bounds, paint the canvas to the final colour and end</span><span>
</span><span>    </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#708090">// else just clear the canvas before drawing the next frame</span><span>
</span><span>    </span><span class="token" style="color:#07a">return</span><span> m</span><span class="token" style="color:#999">.</span><span>drawCircle</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token function-variable" style="color:#dd4a68">drawCircle</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#708090">// note down the time when we started drawing</span><span>
</span><span>    </span><span class="token" style="color:#708090">// draw the circle and go back to the start state</span><span>
</span><span>    </span><span class="token" style="color:#07a">return</span><span> m</span><span class="token" style="color:#999">.</span><span>start</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span></code></pre></div><p>Then I can assign the start function to a variable. Then I can call the function in the variable and keep assigning it back to itself. When it returns null, I won't do another call. This is best illustrated with a code snippet:</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#07a">let</span><span> stateMachine </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> m</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">createMachine</span><span class="token" style="color:#999">(</span><span>ctx</span><span class="token" style="color:#999">,</span><span> isDark</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#708090">// create a state machine and assign it to a variable</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#dd4a68">stateMachineRunner</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=></span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span>stateMachine </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">!==</span><span> </span><span class="token" style="color:#07a">null</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    stateMachine </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#dd4a68">stateMachine</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#708090">// start by calling the function createMachine() returns</span><span>
</span><span>    </span><span class="token" style="color:#dd4a68">stateMachineRunner</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#708090">// keep calling stateMachineRunner() until state machine returns null as the next state</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#dd4a68">stateMachineRunner</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre></div><h4 id="14-create-machine---setup-function">14) Create Machine - setup function</h4><p>We've created a state machine but a setup function is required to set the initial state for all variables. This step will be run only once as an entry point and will be responsible for setting up the canvas resolution and calculating the max radius multiplier. Additionally, this step will decide if the animation should play or not depending if the user actually clicked the dark mode toggle or not.</p><p>If you've made this far into the blog post, that means you're ready to start reading actual code. I'm going to point you to the <a href="https://github.com/celikkoseoglu/celikk-personal-website/blob/master/src/components/Animations/GrowingCircleAnimation.jsx">full canvas component</a>. Read the createMachine() state code yourself. It has the necessary comments.</p><h4 id="15-fixing-weird-bugs-and-glitches">15) Fixing weird bugs and glitches</h4><p>It's time for QA. The first bug we encounter is related with page resizes. A page resize happens when you take a browser window on your laptop and just resize it. The best and easiest thing to do in this case is to reset the state machine altogether. This is a compromise I'm willing to make because the animation takes less than 1 second to complete. A user can't ideally resize the window in less than a second after clicking the dark mode toggle.</p><p>Second bug happens when we pinch to zoom in on a mobile phone and click the dark mode toggle button. When a user does pinch to zoom, scaling factors, window width and other things break. There is <a href="https://stackoverflow.com/questions/442404/retrieve-the-position-x-y-of-an-html-element-relative-to-the-browser-window">yet another StackOverflow post</a> explaining how to fix this issue.</p><div class="Code_parentDiv__2Z7tI"><button aria-label="Copy to Clipboard Button" class="Code_copyButton__BBYCB false" type="button"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></button><pre style='color:#000;background:#f5f2f0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto'><code class="language-javascript" style='color:#000;background:0 0;text-shadow:#fff 0 1px;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#708090">// when mobile device is zoomed in using the pinch gesture,</span><span>
</span><span></span><span class="token" style="color:#708090">// we need to get the relative coordinate on the page.</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> bodyRect </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> document</span><span class="token" style="color:#999">.</span><span>body</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">getBoundingClientRect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> elemRect </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> event</span><span class="token" style="color:#999">.</span><span>target</span><span class="token" style="color:#999">.</span><span class="token" style="color:#dd4a68">getBoundingClientRect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> offsetTop </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> elemRect</span><span class="token" style="color:#999">.</span><span>top </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">-</span><span> bodyRect</span><span class="token" style="color:#999">.</span><span>top</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> offsetLeft </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> elemRect</span><span class="token" style="color:#999">.</span><span>left </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">-</span><span> bodyRect</span><span class="token" style="color:#999">.</span><span>left</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#708090">// this tells us how much the user has zoomed in using the pinch gesture</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> deviceZoomRatio </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> document</span><span class="token" style="color:#999">.</span><span>documentElement</span><span class="token" style="color:#999">.</span><span>clientWidth </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span> window</span><span class="token" style="color:#999">.</span><span>innerWidth</span><span class="token" style="color:#999">;</span><span>
</span> 
<span></span><span class="token" style="color:#07a">const</span><span> customEventState </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">=</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  x</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> offsetLeft </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">+</span><span> elemRect</span><span class="token" style="color:#999">.</span><span>width </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span> </span><span class="token" style="color:#905">2</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#708090">// if the user is pinch zoomed in, then use the pinch zoom coordinate detection logic,</span><span>
</span><span>  </span><span class="token" style="color:#708090">// otherwise, use the distance of the icon from the top of the page. For some reason</span><span>
</span><span>  </span><span class="token" style="color:#708090">// offsetTop doesn't work when the user scrolls down and the zoom ratio == 1 (iOS14)</span><span>
</span><span>  y</span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> </span><span class="token" style="color:#999">(</span><span>deviceZoomRatio </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">></span><span> </span><span class="token" style="color:#905">1</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">?</span><span> offsetTop </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">:</span><span> elemRect</span><span class="token" style="color:#999">.</span><span>top</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">+</span><span> elemRect</span><span class="token" style="color:#999">.</span><span>height </span><span class="token" style="color:#9a6e3a;background:rgba(255,255,255,.5)">/</span><span> </span><span class="token" style="color:#905">2</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span></code></pre></div><p>Third bug happens when we change the scaling factor in iOS safari. When a user switches from dark mode to light mode in a smaller scale and sets a bigger scaling factor, animation won't work anymore. This is due to the radiusMultiplier from the previous state being bigger than the new maxRadiusMultiplier.</p><p>This is it. After this point, I see no benefit of putting code snippets here anymore. From now on, you're better off reading the <a href="https://github.com/celikkoseoglu/celikk-personal-website/blob/master/src/components/Animations/GrowingCircleAnimation.jsx">actual source code</a> than this blog post if you're looking for answers. Shoot me an email if you have questions.</p><h3 id="it-doesnt-mean-its-impossible-to-do-if-there-are-no-other-examples-of-it-on-the-web">It doesn't mean it's impossible to do if there are no other examples of it on the web.</h3><p>Now go and add some personality to your website. Also star <a href="https://github.com/celikkoseoglu/celikk-personal-website">the github repo</a> for this website.</p></div></div><hr class="null HorizontalRuler_clearBorder__2lGUt HorizontalRuler_light__28FMc"></div><div class="BlogPost_footerStyle__c2Yg9"><footer class="BlogFooter_footerStyle__1tWsH"><div class="BlogFooter_title__1t6-Y"><span>Çelik Köseoğlu</span><img alt="signature" class="Signature_signature__3lmZs null null" src="/static/media/signature.c64f85bb.svg"></div><div class="BlogFooter_socialMediaBar__2uODz"><ul class="SocialMediaBar_inlineList__2R1PV SocialMediaBar_noVerticalMargin__21vrN"><li class="SocialMediaIcon_inlineListItem__3ZXqa"><a href="https://twitter.com/celikkoseoglu" class="SocialMediaBar_twitter__3q4li SocialMediaBar_socialMediaButton__3z-3m BlogFooter_socialMediaButtonBackground__BxOsW" aria-label="Twitter Profile"><svg viewBox="0 0 512 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li><li class="SocialMediaIcon_inlineListItem__3ZXqa"><a href="https://www.facebook.com/celikkoseoglu" class="SocialMediaBar_facebook__3e96t SocialMediaBar_socialMediaButton__3z-3m BlogFooter_socialMediaButtonBackground__BxOsW" aria-label="Facebook Profile"><svg viewBox="0 0 320 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"></path></svg></a></li><li class="SocialMediaIcon_inlineListItem__3ZXqa"><a href="https://linkedin.com/in/celikk" class="SocialMediaBar_linkedin__3ZlIT SocialMediaBar_socialMediaButton__3z-3m BlogFooter_socialMediaButtonBackground__BxOsW" aria-label="LinkedIn Profile"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg></a></li><li class="SocialMediaIcon_inlineListItem__3ZXqa"><a href="https://github.com/celikkoseoglu" class="SocialMediaBar_github__3NDew SocialMediaBar_socialMediaButton__3z-3m BlogFooter_socialMediaButtonBackground__BxOsW" aria-label="GitHub Profile"><svg viewBox="0 0 496 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li class="SocialMediaIcon_inlineListItem__3ZXqa"><a href="https://instagram.com/celikkoseoglu" class="SocialMediaBar_instagram__NL289 SocialMediaBar_socialMediaButton__3z-3m BlogFooter_socialMediaButtonBackground__BxOsW" aria-label="Instagram Profile"><svg viewBox="0 0 448 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></a></li><li class="SocialMediaIcon_inlineListItem__3ZXqa"><a href="mailto:celikkoseoglu@yahoo.com" class="SocialMediaBar_mail__15meV SocialMediaBar_socialMediaButton__3z-3m BlogFooter_socialMediaButtonBackground__BxOsW" aria-label="Email Address"><svg viewBox="0 0 512 512" fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a></li></ul></div></footer></div></div></div></div><script>!function(e){function t(t){for(var n,a,f=t[0],d=t[1],u=t[2],i=0,s=[];i<f.length;i++)a=f[i],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&s.push(o[a][0]),o[a]=0;for(n in d)Object.prototype.hasOwnProperty.call(d,n)&&(e[n]=d[n]);for(l&&l(t);s.length;)s.shift()();return c.push.apply(c,u||[]),r()}function r(){for(var e,t=0;t<c.length;t++){for(var r=c[t],n=!0,a=1;a<r.length;a++){var d=r[a];0!==o[d]&&(n=!1)}n&&(c.splice(t--,1),e=f(f.s=r[0]))}return e}var n={},a={13:0},o={13:0},c=[];function f(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,f),r.l=!0,r.exports}f.e=function(e){var t=[];a[e]?t.push(a[e]):0!==a[e]&&{1:1,3:1,15:1,16:1,17:1,18:1,19:1,20:1}[e]&&t.push(a[e]=new Promise((function(t,r){for(var n="static/css/"+({}[e]||e)+"."+{0:"31d6cfe0",1:"0f07196b",2:"31d6cfe0",3:"0c8ec6f4",4:"31d6cfe0",5:"31d6cfe0",6:"31d6cfe0",7:"31d6cfe0",8:"31d6cfe0",9:"31d6cfe0",10:"31d6cfe0",11:"31d6cfe0",15:"afd7172b",16:"afd7172b",17:"afd7172b",18:"afd7172b",19:"aaf23f51",20:"0c8ec6f4",21:"31d6cfe0",22:"31d6cfe0",23:"31d6cfe0",24:"31d6cfe0",25:"31d6cfe0",26:"31d6cfe0",27:"31d6cfe0",28:"31d6cfe0",29:"31d6cfe0",30:"31d6cfe0",31:"31d6cfe0",32:"31d6cfe0",33:"31d6cfe0"}[e]+".chunk.css",o=f.p+n,c=document.getElementsByTagName("link"),d=0;d<c.length;d++){var u=(l=c[d]).getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===n||u===o))return t()}var i=document.getElementsByTagName("style");for(d=0;d<i.length;d++){var l;if((u=(l=i[d]).getAttribute("data-href"))===n||u===o)return t()}var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.onload=t,s.onerror=function(t){var n=t&&t.target&&t.target.src||o,c=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=n,delete a[e],s.parentNode.removeChild(s),r(c)},s.href=o,document.getElementsByTagName("head")[0].appendChild(s)})).then((function(){a[e]=0})));var r=o[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=o[e]=[t,n]}));t.push(r[2]=n);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,f.nc&&d.setAttribute("nonce",f.nc),d.src=function(e){return f.p+"static/js/"+({}[e]||e)+"."+{0:"0c1b73ab",1:"7cd7e342",2:"e00a3864",3:"9be378fe",4:"80d08407",5:"94509b85",6:"bae138dd",7:"d4b8d189",8:"f4a49942",9:"4de39a3d",10:"84e0c3fb",11:"2e0257e6",15:"a35f069b",16:"f9391ddf",17:"484a36d3",18:"f6249094",19:"d1983ef5",20:"a11f8ae3",21:"461848ef",22:"11e28a1e",23:"8ffc431d",24:"7b0864ae",25:"c7c69b46",26:"a71c1a60",27:"22fe7da9",28:"6202977a",29:"680a3bd2",30:"030809b1",31:"ed135832",32:"3efc41cc",33:"2b26bf53"}[e]+".chunk.js"}(e);var u=new Error;c=function(t){d.onerror=d.onload=null,clearTimeout(i);var r=o[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",u.name="ChunkLoadError",u.type=n,u.request=a,r[1](u)}o[e]=void 0}};var i=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(t)},f.m=e,f.c=n,f.d=function(e,t,r){f.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},f.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.t=function(e,t){if(1&t&&(e=f(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(f.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)f.d(r,n,function(t){return e[t]}.bind(null,n));return r},f.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return f.d(t,"a",t),t},f.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},f.p="/",f.oe=function(e){throw console.error(e),e};var d=this["webpackJsonpcelikk-personal-website"]=this["webpackJsonpcelikk-personal-website"]||[],u=d.push.bind(d);d.push=t,d=d.slice();for(var i=0;i<d.length;i++)t(d[i]);var l=u;r()}([])</script><script src="/static/js/14.c3bf32aa.chunk.js"></script><script src="/static/js/main.33779ab0.chunk.js"></script></body></html>